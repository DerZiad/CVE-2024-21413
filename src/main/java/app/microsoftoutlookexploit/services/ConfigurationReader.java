package app.microsoftoutlookexploit.services;

import app.microsoftoutlookexploit.models.Configuration;
import jakarta.mail.Authenticator;
import jakarta.mail.PasswordAuthentication;
import jakarta.mail.Session;

import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.util.Objects;
import java.util.Properties;

public class ConfigurationReader {

    private final static String PROPERTIES_FILE = "config.properties";
    private static Configuration configuration = null;

    public ConfigurationReader() throws FileNotFoundException, IOException {
        configuration = new Configuration();
        Properties properties = new Properties();
        properties.load(new FileInputStream(PROPERTIES_FILE));

        configuration.setUsername(getNonNull(properties,"username"));
        configuration.setPassword(getNonNull(properties,"password"));
        configuration.setSmtpHost(getNonNull(properties,"mail.smtp.host"));
        configuration.setSmtpPort(Integer.parseInt(getNonNull(properties,"mail.smtp.port")));
        configuration.setMustAuth(getNonNull(properties,"mail.smtp.auth").toLowerCase().equals("true"));
        configuration.setStartTLS(getNonNull(properties,"mail.smtp.starttls.enable").toLowerCase().equals("true"));
        configuration.setMailLetterPath(getNonNull(properties,"letter_path"));
        configuration.setMailLetterType(getNonNull(properties,"letter_type"));
        configuration.setListOfEmailPath(getNonNull(properties,"use_exploit").equals("true"));
    }

    private String getNonNull(Properties properties,String path){
        return Objects.requireNonNull(properties.getProperty(path));
    }



    public static ConfigurationReader getInstance(){

    }
}
